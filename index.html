<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Pizza Party üçï</title>
    
    <!-- Farcaster Mini App Meta Tags -->
    <meta property="fc:miniapp" content='{"version":"1","imageUrl":"https://i.imgur.com/gOq5s2k.png","button":{"title":"Bake It!","action":{"type":"launch_frame","name":"Pizza Party","url":"https://pizza-party-v1.vercel.app","splashImageUrl":"https://i.imgur.com/gOq5s2k.png","splashBackgroundColor":"#2D2A26"}}}' />
    <meta property="fc:frame" content='{"version":"1","imageUrl":"https://i.imgur.com/gOq5s2k.png","button":{"title":"Bake It!","action":{"type":"launch_frame","name":"Pizza Party","url":"https://pizza-party-v1.vercel.app","splashImageUrl":"https://i.imgur.com/gOq5s2k.png","splashBackgroundColor":"#2D2A26"}}}' />
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Pizza Party üçï" />
    <meta property="og:description" content="Freshly Baked Since 2025! Mine $PIZZA through continuous Dutch auctions." />
    <meta property="og:image" content="https://i.imgur.com/gOq5s2k.png" />
    <meta property="og:url" content="https://pizza-party-v1.vercel.app" />
    <meta property="og:type" content="website" />
    
    <!-- Twitter Card Meta Tags (optional but recommended) -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Pizza Party üçï" />
    <meta name="twitter:description" content="Freshly Baked Since 2025! Mine $PIZZA through continuous Dutch auctions." />
    <meta name="twitter:image" content="https://i.imgur.com/gOq5s2k.png" />
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/EffectComposer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/RenderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/ShaderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/CopyShader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body class="text-pizza-party-dark">
        
    <main class="flex-grow flex flex-col px-3 pt-4 pb-1 max-w-lg mx-auto w-full"> 
        <div class="flex justify-between items-center mb-2">
            <div class="flex flex-col">
                <h1 class="text-3xl font-black text-pizza-party-red" style="font-family: 'Luckiest Guy', cursive;">Pizza Party</h1>
                
                <div class="bg-pizza-party-card rounded-pizza-party-lg shadow-pizza-party p-2 flex items-center space-x-3 mt-1">
                    <div class="flex-1">
                        <div id="player-profile-name" class="font-extrabold text-sm truncate text-pizza-party-dark">Loading...</div>
                    </div>
                    <button id="connect-wallet-button" class="bg-pizza-party-button-red text-white py-1 px-3 rounded-pizza-party-md text-xs font-bold active:opacity-80 shadow-pizza-party whitespace-nowrap">
                        Connect
                    </button>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-1 self-start">
                <button id="dark-mode-toggle-button" class="bg-pizza-party-button-green text-white text-base w-8 h-8 flex items-center justify-center rounded-pizza-party-md shadow-pizza-party active:opacity-80">üåô
                </button>
                <button id="info-button" class="bg-pizza-party-button-red text-white text-base w-8 h-8 flex items-center justify-center rounded-pizza-party-md shadow-pizza-party active:opacity-80">‚ùì
                </button>
                <button id="music-toggle-button" class="bg-pizza-party-button-red text-white text-base w-8 h-8 flex items-center justify-center rounded-pizza-party-md shadow-pizza-party active:opacity-80">üîá
                </button>
                <button id="sfx-toggle-button" class="bg-pizza-party-button-green text-white text-base w-8 h-8 flex items-center justify-center rounded-pizza-party-md shadow-pizza-party active:opacity-80">üîä
                </button>
            </div>
        </div>

        <div id="view-pizzeria" class="flex-grow flex flex-col">
            <div class="bg-pizza-party-card rounded-pizza-party-lg shadow-pizza-party p-2 grid grid-cols-3 gap-2">
                <div class="text-center">
                    <div class="text-xs text-gray-500 font-semibold">Head Chef</div>
                    <div id="pizzeria-chef-status" class="font-extrabold text-sm truncate text-pizza-party-dark">Loading...</div>
                </div>
                <div class="text-center">
                    <div class="text-xs text-gray-500 font-semibold">Baked</div>
                    <div class="font-extrabold text-sm text-pizza-party-dark">üçï <span id="pizzeria-pps">0.00</span></div>
                </div>
                <div class="text-center">
                    <div class="text-xs text-gray-500 font-semibold">Bake Time</div>
                    <div class="font-extrabold text-sm text-pizza-party-dark"><span id="pizzeria-baked-time">00:00:00</span></div>
                </div>
            </div>

            <div id="top-ticker" class="ticker-wrap" style="margin-bottom: 4px; margin-top: 8px;">
                <div class="ticker-move">
                    <span>Pizza Party... Get a slice! Pizza Party... Get a slice! Pizza Party... Get a slice! Pizza Party... Get a slice! Pizza Party... Get a slice! Pizza Party... Get a slice! </span>
                </div>
            </div>

            <div id="pizza-slice-container" class="relative h-56 flex items-center justify-center overflow-hidden bg-pizza-party-card rounded-pizza-party-lg shadow-pizza-party glitch-static">
                <div class="falling-snow"></div> <!-- This class name is kept for the static effect, but we can change it -->
                <canvas id="pizza-canvas"></canvas>
                <button id="view-toggle-button" class="shadow-pizza-party">üßä</button>
                <button id="sauce-color-button" class="color-cycle-button shadow-pizza-party bg-white text-pizza-party-dark">ü•´</button>
                <button id="topping-color-button" class="color-cycle-button shadow-pizza-party bg-white text-pizza-party-dark">üå∂Ô∏è</button>
                <button id="crust-color-button" class="color-cycle-button shadow-pizza-party bg-white text-pizza-party-dark">üçû</button>
                <input id="pizzeria-zoom-slider" type="range" class="zoom-slider">
            </div>

            <div id="bottom-ticker" class="ticker-wrap" style="margin-top: 4px;">
                <div class="ticker-move-reverse">
                    <span>Pizza Party... Get a slice! Pizza Party... Get a slice! Pizza Party... Get a slice! Pizza Party... Get a slice! Pizza Party... Get a slice! Pizza Party... Get a slice! </span>
                </div>
            </div>
            
            <div id="bake-party-wrapper" class="bake-party-container flex flex-col justify-start"> 
                
                <div id="bake-container">
                    <div class="bg-pizza-party-card text-pizza-party-dark p-2 rounded-pizza-party-lg shadow-pizza-party">
                        <div class="flex justify-between items-center">
                            <div>
                                <div class="text-xs font-semibold text-gray-600">Bake Price</div>
                                <div id="bake-price-display" class="text-xl font-extrabold text-pizza-party-dark">$0.00</div>
                                <div id="available-balance-display" class="text-xs text-gray-500">$0.00 available</div>
                            </div>
                            
                            <div class="flex flex-col items-end">
                                <button id="pizzeria-action-button" class="bg-pizza-party-button-red text-white py-2 px-6 rounded-pizza-party-md text-sm font-bold active:opacity-80 disabled:opacity-50 shadow-pizza-party">
                                    Bake
                                </button>
                                <div class="text-right mt-1"> 
                                    <div class="text-xs font-semibold text-gray-600">Pizzas/s</div>
                                    <div id="bake-pps-display" class="text-sm font-extrabold text-pizza-party-dark">0.00</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="party-container" class="hidden"> 
                    <div class="bg-pizza-party-card text-pizza-party-dark p-2 rounded-pizza-party-lg shadow-pizza-party">
                        <div class="flex justify-between items-center">
                            <div>
                                <div class="text-xs font-semibold text-gray-600">
                                    Party Price (<a id="lp-token-link" href="#" target="_blank" rel="noopener noreferrer" class="text-pizza-party-red hover:underline">LP</a>)
                                </div>
                                <div id="party-price-display" class="text-xl font-extrabold text-pizza-party-dark">0.00</div>
                                <div id="party-available-balance-display" class="text-xs text-gray-500">0.00 LP available</div>
                            </div>
                            
                            <div class="flex flex-col items-end">
                                <button id="party-action-button" class="bg-pizza-party-button-green text-white py-2 px-6 rounded-pizza-party-md text-sm font-bold active:opacity-80 disabled:opacity-50 shadow-pizza-party">
                                    Party
                                </button>
                                <div class="text-right mt-1">
                                    <div class="text-xs font-semibold text-gray-600">Claim</div>
                                    <div id="party-claim-amount" class="text-sm font-extrabold text-pizza-party-dark">0.00 ETH</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-pizza-party-card rounded-pizza-party-lg shadow-pizza-party p-2 grid grid-cols-3 gap-2 mt-2">
                <div class="text-center">
                    <div class="text-xs text-gray-500 font-semibold">Pizza Balance</div>
                    <div id="player-pizza-balance" class="font-extrabold text-sm truncate text-pizza-party-dark">üçï 0</div>
                </div>
                <div class="text-center">
                    <div class="text-xs text-gray-500 font-semibold">Total Supply</div>
                    <div id="total-supply-display" class="font-extrabold text-sm text-pizza-party-dark">üçï 0</div>
                </div>
                <div class="text-center">
                    <div class="text-xs text-gray-500 font-semibold">% Held</div>
                    <div id="current-pps-display" class="font-extrabold text-sm text-pizza-party-dark">0</div>
                </div>
            </div>

        </div>
    </main>

    <div id="info-modal-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>
    <div id="info-modal" class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-pizza-party-card rounded-pizza-party-lg shadow-pizza-party p-4 z-50 hidden w-11/12 max-w-xs text-pizza-party-dark overflow-y-auto" style="max-height: 90vh;">
        <div class="flex justify-between items-center mb-2">
            <h3 class="text-xl font-bold text-pizza-party-red">Info</h3>
            <button id="info-modal-close" class="text-2xl font-bold text-gray-500 hover:text-pizza-party-red">&times;</button>
        </div>
        <div class="space-y-3">
            
            <div class="bg-pizza-party-card rounded-pizza-party-lg shadow-pizza-party p-4 space-y-4 text-pizza-party-dark">
                <h2 class="text-lg font-bold text-pizza-party-red">What Is $PIZZA?</h2>
                <p class="text-sm">$PIZZA is a store-of-value token on Base, mined through a continuous Dutch auction instead of proof-of-work or staking. Auction revenue increases $PIZZA's liquidity and scarcity.</p>
        
                <h2 class="text-lg font-bold text-pizza-party-red">How Mining Works</h2>
                <p class="text-sm">Only one active miner at a time, called the Head Chef. The right to mine is bought with ETH through a continuous Dutch auction:</p>
                <ul class="list-disc list-inside text-sm pl-4">
                    <li>Price doubles after each purchase</li>
                    <li>Then decays to 0 over one hour</li>
                    <li>Anyone can purchase control of emissions at the current price</li>
                </ul>
        
                <h2 class="text-lg font-bold text-pizza-party-red">Fee Split</h2>
                <ul class="list-disc list-inside text-sm pl-4">
                    <li><strong>80%</strong> &rarr; previous Head Chef</li>
                    <li><strong>15%</strong> &rarr; treasury (Partyzone)</li>
                    <li><strong>5%</strong> &rarr; provider (frontend host)</li>
                </ul>
        
                <h2 class="text-lg font-bold text-pizza-party-red">Emission Schedule</h2>
                <ul class="list-disc list-inside text-sm pl-4">
                    <li>Starts at 10 PIZZA / sec</li>
                    <li>Halving every 10 days</li>
                    <li>Tail emission: 0.01 PIZZA / sec (forever)</li>
                </ul>
        
                <h2 class="text-lg font-bold text-pizza-party-red">Proof of Just-In-Time Stake</h2>
                <ul class="list-disc list-inside text-sm pl-4">
                    <li>ETH is "staked" only while controlling emissions</li>
                    <li>Profit if the next purchase pays more</li>
                    <li>Lose if it pays less</li>
                    <li>Earn $PIZZA the entire time you hold control</li>
                </ul>
        
                <h2 class="text-lg font-bold text-pizza-party-red">Treasury</h2>
                <p class="text-sm">Treasury ETH is used to buy and burn PIZZA-WETH LP in the Partyzone. Once sufficient liquidity is established, the Pizzeria can be upgraded to buy and burn PIZZA directly, or governance can decide to acquire other assets or reinvest the treasury.</p>
        
                <h2 class="text-lg font-bold text-pizza-party-red">Builder Codes</h2>
                <p class="text-sm">Anyone can host their own Pizza Shop by deploying a frontend. Add your builder code to earn 5% of all purchases made through your shop. The protocol will launch with two official Pizza Shops:</p>
                <ul class="list-disc list-inside text-sm pl-4">
                    <li>Slice Corp by @heesh</li>
                    <li>Pizza Party by @bigbroc</li>
                </ul>
        
                <h2 class="text-lg font-bold text-pizza-party-red">Thank you from Pizza Party</h2>
                <p class="text-sm">Freshly Baked Since 2025!</p>
            </div>
            <h3 class="text-xl font-bold text-pizza-party-red pt-2">Global Pizza Stats</h3>
            <div class="bg-pizza-party-card rounded-pizza-party-lg shadow-pizza-party p-4 space-y-3 text-pizza-party-dark">
                <div class="flex justify-between items-center">
                    <span class="text-sm font-semibold text-gray-600">Total Pizza Supply</span>
                    <span id="modal-total-supply" class="font-extrabold text-pizza-party-dark">üçï 0</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-sm font-semibold text-gray-600">Time Until Halving</span>
                    <span id="modal-next-halving" class="font-extrabold text-pizza-party-dark">--:--:--</span>
                </div>
                <div class="flex justify-between items-center">
                    <span id="modal-current-miner-label" class="text-sm font-semibold text-gray-600">Current Miner</span>
                    <span id="modal-current-miner" class="font-extrabold text-pizza-party-dark text-xs">None</span>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js" type="module"></script>
</body>
</html>
